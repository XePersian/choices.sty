%%
%% This is file `multiple-choices.sty'.
%%
%% LaTeX package for multiple choices question
%%
%% Copyright © 2022
%% ------------------------------------------------------------------
%%  Author: Seiied-Mohammad-Javad Razavian <javadr at gmail dot com>
%%
%%  This work may be distributed and/or modified under the
%%  conditions of the Latex Project Public License, either
%%  version 1.3 of this license or (at your option) any
%%  later version.
%%  The latest version of the license is in
%%    http://www.latex-project.org/lppl.txt
%%  and version 1.3 or later is part of all distributions of
%%  LaTeX version 2003/06/01 or later.
%%
%%  This work has the LPPL maintenance status `maintained'.
%%  This work is “author-maintained” (as per LPPL maintenance status).
%%  The Current Maintainer of this work is Seiied-Mohammad-Javad Razavian.
%% ------------------------------------------------------------------
%%
\NeedsTeXFormat{LaTeX2e}
\def\choicesdate{2022/06/24}
\def\choicesversion{0.2}
\ProvidesPackage{multiple-choices}[\choicesdate\space v\choicesversion^^JMultiple choices question with automatic adjustment of the choices based on their widths]
\RequirePackage{biditools}
\newdimen\cho@ChoiceLabelWidth
\newdimen\cho@ChoiceLabelSep
\cho@ChoiceLabelWidth=1.5em
\cho@ChoiceLabelSep=0.5em
\newcounter{cho@MultChoiceCount}
\newcommand{\cho@InitialChoice}{%
    \ifnum\value{cho@MultChoiceCount}>\z@
        \cr
    \fi
    \stepcounter{cho@MultChoiceCount}%
    \hbox to \cho@ChoiceLabelWidth{\hss(\Alph{cho@MultChoiceCount})}%
    \kern\cho@ChoiceLabelSep
}%
\newcommand{\cho@FinalChoice}{%
    \ifnum\value{cho@MultChoiceCount}>\z@
        \egroup
        \egroup
    \fi
    \stepcounter{cho@MultChoiceCount}%
    \hspace{0pt plus 1pt}%
    \hbox\bgroup
    \hbox to \cho@ChoiceLabelWidth{\hss(\Alph{cho@MultChoiceCount})}%
    \kern\cho@ChoiceLabelSep
        \vtop\bgroup
        \hsize\cho@MultChoicesWidth
        \advance\hsize-\cho@ChoiceLabelWidth
        \advance\hsize-\cho@ChoiceLabelSep
}%
\newbox\cho@MultChoicesBox
\newdimen\cho@MultChoicesWidth
\newcommand{\cho@ComputeMultChoicesWidth}[1]{%
    \setbox\cho@MultChoicesBox\hbox{%
        \vbox{%
        \halign{%
            ##\hfil\cr
            #1\crcr
        }%
        }%
    }%
}%
% MultipltChoices Environment.
\newenvironment{choices}{%
    \setcounter{cho@MultChoiceCount}{0}%
    \let\choice\cho@InitialChoice
    \bidi@collect@long@body\cho@ComputeMultChoicesWidth
}{%
    \cho@MultChoicesWidth-\fontcharwd\font`
    \advance\cho@MultChoicesWidth\wd\cho@MultChoicesBox
    \ifdim\cho@MultChoicesWidth>0.5\linewidth
        \cho@MultChoicesWidth=\linewidth
    \else
        \ifdim\cho@MultChoicesWidth>0.25\linewidth
        \cho@MultChoicesWidth=0.5\linewidth
        \else
        \cho@MultChoicesWidth=0.25\linewidth
        \fi
    \fi
    \setcounter{cho@MultChoiceCount}{0}%
    \let\choice\cho@FinalChoice
    \parindent\z@
    \ifvmode
    \else
        \par
    \fi
    \the\@bidi@envbody
    \egroup
    \egroup
}%
%%
%%
%% End of file `choices.sty'.
